<!DOCTYPE html>

<html>
<head>
  <title>getopt.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>

      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">


                <a class="source" href="arguable.html">
                  arguable.js
                </a>


                <a class="source" href="bindable.html">
                  bindable.js
                </a>


                <a class="source" href="exit.html">
                  exit.js
                </a>


                <a class="source" href="getopt.html">
                  getopt.js
                </a>


                <a class="source" href="numeric.html">
                  numeric.js
                </a>


                <a class="source" href="program.html">
                  program.js
                </a>


                <a class="source" href="usage.html">
                  usage.js
                </a>

            </div>
          </div>
        </li>
      </ul>

    <ul class="sections">

          <li id="title">
              <div class="annotation">
                  <h1>getopt.js</h1>
              </div>
          </li>



        <li id="section-1">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>

            </div>

            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getopt</span> (<span class="hljs-params">patterns, argv</span>) </span>{
    patterns = patterns.map(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">pattern</span>) </span>{
        <span class="hljs-keyword">return</span> {
            arguable: pattern.arguable,
            verbose: <span class="hljs-string">'--'</span> + pattern.verbose,
            terse: pattern.terse ? <span class="hljs-string">'-'</span> + pattern.terse : <span class="hljs-string">''</span>,
            key: pattern.verbose
        }
    })

    <span class="hljs-keyword">var</span> ordered = []

    <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, terminal = <span class="hljs-literal">false</span>
    <span class="hljs-keyword">for</span> (;;) {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> argv[<span class="hljs-number">0</span>] == <span class="hljs-string">'object'</span>) {
            ordered.push(argv.shift())
            <span class="hljs-keyword">continue</span>
        }
        <span class="hljs-keyword">if</span> (argv[<span class="hljs-number">0</span>] == <span class="hljs-string">'--'</span>) {
            <span class="hljs-keyword">break</span>
        }
        <span class="hljs-keyword">if</span> (argv.length == <span class="hljs-number">0</span> || !<span class="hljs-regexp">/^--?[^-]/</span>.test(argv[<span class="hljs-number">0</span>])) {
            <span class="hljs-keyword">break</span>
        }
        <span class="hljs-keyword">var</span> arg = argv.shift()
        <span class="hljs-keyword">var</span> $ = <span class="hljs-regexp">/^(--[^=]+)=(.*)$/</span>.exec(arg) || <span class="hljs-regexp">/^(-[^-])(.+)$/</span>.exec(arg) || [<span class="hljs-literal">false</span>, arg, <span class="hljs-literal">true</span>]
        <span class="hljs-keyword">var</span> catenated = !! $[<span class="hljs-number">0</span>]
        <span class="hljs-keyword">var</span> parameter = $[<span class="hljs-number">1</span>]
        <span class="hljs-keyword">var</span> value = $[<span class="hljs-number">2</span>]
        <span class="hljs-keyword">var</span> isLong = parameter[<span class="hljs-number">1</span>] == <span class="hljs-string">'-'</span>
        <span class="hljs-keyword">var</span> alternates = patterns.filter(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">pattern</span>) </span>{
            <span class="hljs-keyword">return</span> pattern.verbose.lastIndexOf(parameter, <span class="hljs-number">0</span>) == <span class="hljs-number">0</span>
                || pattern.terse.lastIndexOf(parameter, <span class="hljs-number">0</span>) == <span class="hljs-number">0</span>
        })
        <span class="hljs-keyword">if</span> (alternates.length != <span class="hljs-number">1</span>) {
            <span class="hljs-keyword">throw</span> {
                abend: alternates.length ? <span class="hljs-string">'ambiguous argument'</span> : <span class="hljs-string">'unknown argument'</span>,
                context: parameter
            }
        }

        <span class="hljs-keyword">var</span> pattern = alternates.shift()
        <span class="hljs-keyword">if</span> (pattern.arguable) {
            <span class="hljs-keyword">if</span> (!catenated) {
                <span class="hljs-keyword">if</span> (argv.length == <span class="hljs-number">0</span>) {
                    <span class="hljs-keyword">throw</span> {
                        abend: <span class="hljs-string">'missing argument'</span>,
                        context: isLong ? pattern.verbose : pattern.terse
                    }
                }
                value = argv.shift()
            }
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (catenated) {
            <span class="hljs-keyword">if</span> (isLong) {
                <span class="hljs-keyword">throw</span> {
                    abend: <span class="hljs-string">'unexpected argument value'</span>,
                    context: pattern.verbose
                }
            } <span class="hljs-keyword">else</span> {
                argv.unshift(<span class="hljs-string">'-'</span> + value)
                value = <span class="hljs-literal">true</span>
            }
        }

        ordered.push({ name: pattern.key, value: value })

        i++
    }

</pre></div></div>

        </li>


        <li id="section-2">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>TODO Implement <code>--no-foo</code>.
<a href="https://github.com/trentm/node-dashdash/pull/13">https://github.com/trentm/node-dashdash/pull/13</a>
<a href="http://stackoverflow.com/questions/9234258/in-python-argparse-is-it-possible-to-have-paired-no-something-something-arg/9236426#9236426">http://stackoverflow.com/questions/9234258/in-python-argparse-is-it-possible-to-have-paired-no-something-something-arg/9236426#9236426</a>
<a href="http://stackoverflow.com/questions/9234258/in-python-argparse-is-it-possible-to-have-paired-no-something-something-arg">http://stackoverflow.com/questions/9234258/in-python-argparse-is-it-possible-to-have-paired-no-something-something-arg</a></p>

            </div>

            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">return</span> ordered
}

<span class="hljs-built_in">module</span>.exports = getop

</pre></div></div>

        </li>

    </ul>
  </div>
</body>
</html>
